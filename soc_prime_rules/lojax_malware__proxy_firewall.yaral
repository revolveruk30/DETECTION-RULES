rule lojax_malware_proxyfirewall {
 meta:
    author = "Alexandr Yampolskyi, SOC Prime"
    description = "LoJax rootkit Detector (Sednit group).  License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md."
    reference = "https://tdm.socprime.com/tdm/info/4u2R42YOCfm0"
    version = "0.01"
    created = "2019/01/17"
    product = "proxy"
    mitre = "Command and Control, t1071"

  events:
(($SelectionSRC.principal.ip = "185.77.129.106" or $SelectionSRC.principal.ip = "185.144.82.239" or $SelectionSRC.principal.ip = "93.113.131.103" or $SelectionSRC.principal.ip = "185.86.149.54" or $SelectionSRC.principal.ip = "185.86.151.104" or $SelectionSRC.principal.ip = "103.41.177.43" or $SelectionSRC.principal.ip = "185.86.148.184" or $SelectionSRC.principal.ip = "185.94.191.65" or $SelectionSRC.principal.ip = "86.106.131.54" or $SelectionSRC.principal.ip = "169.239.12.133" or $SelectionSRC.principal.ip = "185.86.151.2") or ($SelectionSRC.target.ip = "185.77.129.106" or $SelectionSRC.target.ip = "185.144.82.239" or $SelectionSRC.target.ip = "93.113.131.103" or $SelectionSRC.target.ip = "185.86.149.54" or $SelectionSRC.target.ip = "185.86.151.104" or $SelectionSRC.target.ip = "103.41.177.43" or $SelectionSRC.target.ip = "185.86.148.184" or $SelectionSRC.target.ip = "185.94.191.65" or $SelectionSRC.target.ip = "86.106.131.54" or $SelectionSRC.target.ip = "169.239.12.133" or $SelectionSRC.target.ip = "185.86.151.2") or (re.regex($SelectionSRC.target.hostname, `.*secao\.org.*`) or re.regex($SelectionSRC.target.hostname, `.*ikmtrust\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*sysanalyticweb\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*lxwo\.org.*`) or re.regex($SelectionSRC.target.hostname, `.*jflynci\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*remotepx\.net.*`) or re.regex($SelectionSRC.target.hostname, `.*rdsnets\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*rpcnetconnect\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*webstp\.com.*`) or re.regex($SelectionSRC.target.hostname, `.*elaxo\.org.*`)))

  condition:
    $SelectionSRC
}
