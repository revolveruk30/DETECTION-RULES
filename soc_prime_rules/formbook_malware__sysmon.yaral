rule formbook_malware_sysmon {
 meta:
    author = "Alexandr Yampolskyi, SOC Prime"
    description = "FormBook Malware Detector.  License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md."
    reference = "https://tdm.socprime.com/tdm/info/UHPW2CPgdyAH"
    version = "0.01"
    created = "2019/01/10"
    product = "windows"
    service = "sysmon"
    mitre = "Execution, t1204"

  events:
($selection.metadata.product_event_type = "1" and ($selection.target.file.md5 = "d7f0f3fea2f9935c1dd7bda343ec1e3fb77457e68b16b9d51516a3d8c651d14f" or $selection.target.file.md5 = "05a945fc7a9eb4c9a4db8eb974333b3938c06d9299976075b2fc00a79cf0a129" or $selection.target.file.md5 = "91a471ba534219f05c31d204b3c5217cde7c67f70600aa3abba334888f628376" or $selection.target.file.md5 = "f7e97000615ee77093c4ec49f3cbe4b8cb3dc6feafc74ae8d59f01f05dc4280e" or $selection.target.file.md5 = "23c40f55797b07b2d9bf1e314ea928b1151af2b2e605aa520a715fe56e481528" or $selection.target.file.md5 = "1d706a3c85973fe96240a254abff52c0593b4aa0c283d3ecc28df6f8baed853b" or $selection.target.file.md5 = "e8f0136abc46b668d44586a6b5a394b470af6af8e9d91bddca4b70e3e66768d1" or $selection.target.file.md5 = "958ee876ebaab71ea2ef9fcda6a08598319578ccc1f4bd9baa3a54114b88abdc" or $selection.target.file.md5 = "b031075b8ad2558ee3ee7f0749c2b24484dd6fab7252fad71548276514b9b766" or $selection.target.file.md5 = "667cc420816fd71ae54869b4c0f05129cc5972dbc47f7a98776fc63a72d77691" or $selection.target.file.md5 = "7db8273fd25088900cffa036eb631ffcee40302dd7b33a7d4f3e653e7ab091c0" or $selection.target.file.md5 = "3efdc8b15e324cd9323cdbd34fbd19979d6eeb95fe1120ed3a95dc24fab67397" or $selection.target.file.md5 = "189e2494b19773f9b72072774891378f5809c7bfb121dcba2cee13e6f91ed619" or $selection.target.file.md5 = "bd44861de18d5bbf71d2d64e29ff9f1d8495f97f5ba0b49eacb504b3768a89bb" or $selection.target.file.md5 = "e0282f51ac3bfba5774893c8b70c31600d7e4bd7f6d7231fd33315396cd18b78" or $selection.target.file.md5 = "83fa11d8711ef22437681e09a4be500cfaf49ac7cb29837ff6a42fb46b09d789" or $selection.target.file.md5 = "14ce215b561dc43104e400c0eb877d876f6e9be77c5b2994b9b8745b2132d914" or $selection.target.file.md5 = "226d38382415b935d849539c0b6305a4259c26dfa7317b944f8498cd3e65850f" or $selection.target.file.md5 = "dd1eeb128b1d1eb40e74281aec79828d7d7179a0375bda5e85ce5fd2fac064a2" or $selection.target.file.md5 = "a7422eddb437a33d730ab70bd1267d815fc3761d5eda9781de91d0bdeeb823ff" or $selection.target.file.md5 = "2a21f728282b33b89e6cbd99db52651931b534be9837d99eacf87cfd748c3cba" or $selection.target.file.md5 = "91b6219f4a8903773492fd83fe02e6aa8729e378f559c5cc9f115a2304f89e57" or $selection.target.file.md5 = "4f73923c23354ac5050f012f607342362eaf1d691ce1b64ea1e831038cc4236c" or $selection.target.file.md5 = "ebbed2fcd7fe4dc8a95cc60ab9c8e98609bcf3ba5696507252c65cc6be748b14" or $selection.target.file.md5 = "d1f9549943b936ba54d87a5befd2d241fcddac6f0caf8c786f6034ab18b8e61d" or $selection.target.file.md5 = "ae7cacc7a16cb48cb40473ad0269331c392f8eb0fef8ebe2d90f3592fccb306c" or $selection.target.file.md5 = "00cb817330768b33a30bcf7a6a67d0269aa32f8099aee3ecd18da0e31d096610" or $selection.target.file.md5 = "e93994bf78b13d3bdee1682faf6c6544246fbd6d95a0aa043ac175ad0b905646" or $selection.target.file.md5 = "822c1239203db0bfdde3d0b65f50e53f7ee155638d4743b14f58267fa3e76531" or $selection.target.file.md5 = "5aac259cb807a4c8e4986dbc1354ef566a12ced381b702a96474c0f8ff45f825" or $selection.target.file.md5 = "8f6813634cb08d6df72e045294bf63732c0753f79293f1c9b2765f686f699a72" or $selection.target.file.md5 = "82ce499994e4b2ee46e887946ef43f18b046639e81dfe1d23537ce6a530d8794" or $selection.target.file.md5 = "4c16046966a5fd06c84213aa67bfa37949800980915e9b511384ec17dc7eb7b1" or $selection.target.file.md5 = "04f093a3b867918dce921fe2ba40dcdae769b35dbce3047aacdb151e2208ea5c" or $selection.target.file.md5 = "59cf77148cbbf24d395d09192ce43ac5395087f3e499cda350e3a93f13e37de1" or $selection.target.file.md5 = "D83f874dda2fa3e4339399c786e9497c1b440019fa5ee5925738fc3afa67352c" or $selection.target.file.md5 = "35ea3d8272751d60bd3106e548444588b1959622dfdcf11be14b80786bdb25e6" or $selection.target.file.md5 = "5e9979a9676889a6656cbfa9ddc1aab2fa4b301155f5b55377a74257c9f9f583" or $selection.target.file.md5 = "0b0615eb8e4c91983fab37475ecc374f79c394768a33ea68c2208da1c03e5a43" or $selection.target.file.md5 = "Fccc874f4f741231673f5a3c0bdc4c6bfd07f1b1e93f7c64e2015c393966216e" or $selection.target.file.md5 = "13ce56581c8ad851fc44ad6c6789829e7c250b2c8af465c4a163b9a28c9b8a41" or $selection.target.file.md5 = "541ea322a3a6385211566f95cef333580a62341dac397e044a04504625acdd0d" or $selection.target.file.md5 = "062ae7152d8e8f3abb093e55c5a90213134dd278ac28cfeb18e81132232dcbe8" or $selection.target.file.md5 = "0ddf7e87957932650679c99ff2e2380e2be8a203d1142f19a22ad602047f372e" or $selection.target.file.md5 = "1debc4e22a40f4f87142e7e40094ce1a9aa10462f0c6d1c29aa272d7d6849205" or $selection.target.file.md5 = "701b1549152e2c460c8c67008c3bcc0e" or $selection.target.file.md5 = "6badb8ff9a65ad709ef8674bb78a8ec0497de536b35fe6b8c6e6d76d17926d54"))

  condition:
    $selection
}
